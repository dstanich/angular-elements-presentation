<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Create Reusable Custom Elements with Angular Elements</title>

    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/white.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css" />

    <link rel="stylesheet" href="custom.css" />

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match(/print-pdf/gi)
        ? 'css/print/pdf.css'
        : 'css/print/paper.css';
      document.getElementsByTagName('head')[0].appendChild(link);
    </script>

    <script src="./examples/greeting-element.js"></script>
    <script src="./examples/demo-elements.js"></script>
  </head>
  <body>
    <div class="reveal">
      <!-- <div class="header">
        dd
      </div> -->
      <!-- <div class="footer">
        Use left and right arrows to navigate
      </div> -->

      <div class="slides">
        <section>
          <h3>Create Reusable Custom Elements<br />with Angular Elements</h3>
          <h4 style="margin-top: 2em">David Stanich</h4>

          <a
            href="https://dstanich.github.io/angular-elements-presentation/"
            target="presentation"
            style="font-size: .75em; margin-top:2em"
            >https://dstanich.github.io/angular-elements-presentation/</a
          >
        </section>

        <section>
          <h3>Background</h3>
          <div style="display: flex;">
            <div style="flex: 1 1 75%">
              <ul>
                <li>Advisory Software Engineer</li>
                <li>IBM Watson Health</li>
                <li>Frontend development</li>
                <li>Co-organizer Rochester FED@IBM meetup</li>
              </ul>
              <div style="margin-top: 2em; text-align: center">
                <span style="margin-right: 1.5em">
                  Twitter:
                  <a href="https://twitter.com/dstanich" target="twitter"
                    >@dstanich</a
                  >
                </span>
                <span>
                  GitHub:
                  <a href="https://github.com/dstanich" target="gh">dstanich</a>
                </span>
              </div>
            </div>
            <div style="flex: 1 1 25%">
              <img src="images/packers_hat.jpg" />
            </div>
          </div>
        </section>

        <section>
          <section>
            <h3>What are custom elements?</h3>
          </section>

          <section>
            <div>
              Custom HTML tags that encapsulate functionality.
              <br />Registered by a JavaScript API.
            </div>
            <pre style="margin-top: 2em"><code data-trim>
              customElements.define('my-element', MyElement);
            </code></pre>

            <pre style="margin-top: 1em"><code data-trim>
              <my-element some-attribute="a value"></my-element>
            </code></pre>

            <a
              href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements"
              target="_blank"
              style="display: block; margin-top: 3em; font-size: .75em"
              >MDN Docs</a
            >
          </section>

          <section>
            <h3>Web Components</h3>
            <div>
              Web Components are several standards combined which allow reusable
              custom elements that are completely encapsulated.
            </div>
            <div style="margin-top: 2em">
              Custom Elements are one of these standards.
            </div>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/Web_Components"
              target="_blank"
              style="display: block; margin-top: 3em; font-size: .75em"
              >MDN Docs</a
            >
          </section>

          <section>
            <script>
              function updateUser() {
                // Updates the custom element with the new attribute
                const user = document.getElementById('new-user').value;
                document
                  .getElementsByTagName('greet-user')[0]
                  .setAttribute('user', user);
              }
            </script>
            <h3>Example</h3>
            <div style="background: #fff;">
              <greet-user user="David"></greet-user>
              <br /><br />
              <input
                id="new-user"
                type="text"
                placeholder="New user value..."
                style="font-size: 1em"
              />
              <button onclick="updateUser()" style="font-size: 1em">
                Update attribute
              </button>
            </div>
          </section>
        </section>

        <section>
          <section>
            <h3>
              Angular Elements<br />
              <code style="font-size: .75em">@angular/elements</code>
            </h3>
          </section>

          <section>
            <h3>What?</h3>
            <ul>
              <li>
                Packages Angular components as custom elements
              </li>
              <li>
                Registers components with <code>CustomElementRegistry</code>
              </li>
              <li>
                Contains Angular runtime to bridge with DOM
              </li>
            </ul>
            <a
              href="https://angular.io/guide/elements"
              target="_blank"
              style="margin-top: 2em; display: block"
              >Elements Documentation</a
            >
          </section>

          <section>
            <h3>Why?</h3>
            <ul>
              <li>Angular within React/Vue/Vanilla</li>
              <li>Pieces of app may be Angular (ex: CMS)</li>
              <li>Migration path for AngularJS</li>
              <li>Inject Angular within JSP/Jade/etc</li>
              <li>Easier dynamic components within Angular</li>
            </ul>
          </section>

          <section>
            <h3>Example:</h3>
            <custom-title text="Hello World"></custom-title>
          </section>
        </section>

        <section>
          <section><h2>Setting Up</h2></section>

          <section>
            <h3>Summary</h3>
            <ol>
              <li>Install dependencies</li>
              <li>Update config if no polyfill</li>
              <li>Configure module</li>
              <li>Define elements</li>
              <li>Setup build</li>
            </ol>
          </section>

          <section>
            <h3>Install Dependencies</h3>
            <div>NPM install or ng add</div>
            <pre><code data-trim>
                // No polyfill; limited browser support
                npm install @angular/elements --save-dev

                // Polyfill included
                ng add @angular/elements
            </code></pre>
          </section>

          <section>
            <h3>Update Config If No Polyfill</h3>
            <div>If no polyfill, force output to es2015</div>
            <pre><code data-trim>
                {
                  // ...
                  "compilerOptions": {
                    // ...
                    "target": "es2015"
                  }
                }
            </code></pre>
          </section>

          <section>
            <h3>Configure Module</h3>
            <ul>
              <li>Remove <code>bootstrap</code> property</li>
              <li>Add empty <code>ngDoBootstrap()</code> method</li>
              <li>Add <code>entryComponents</code> property</li>
              <li>Import <code>createCustomElement</code> from elements</li>
            </ul>
          </section>

          <section>
            <h3>Define Elements</h3>
            <pre><code data-trim>
                constructor(private injector: Injector) {
                  const el = createCustomElement(TitleComponent, 
                      { injector: this.injector }
                  );
                  customElements.define('custom-title', el);

                  // ...
                }
            </code></pre>
          </section>

          <section>
            <h3>Setup Build</h3>
            <div><code>angular-cli</code> does not have build for elements</div>
            <pre style="margin-top: 2em"><code data-trim>
                // Prod build, disable hashing in output
                ng build --prod --output-hashing none

                // Concat the scripts into single .js file
                cat runtime* polyfills* main* scripts* > elements.js
            </code></pre>
          </section>

          <section>
            <h3>Example</h3>
          </section>
        </section>

        <section>
          <section>
            <h2>Using the Custom Elements</h2>
          </section>

          <section>
            <h2>Overview</h2>
            <ul>
              <li>Import .js file into HTML</li>
              <li>Use custom element like normal tag</li>
              <li>Inputs are attributes</li>
              <li>Outputs are custom events</li>
            </ul>
          </section>

          <section>
            <h2>HTML Import</h2>
            <pre><code data-trim>
                &lt;!DOCTYPE html&gt;
                &lt;html lang="en"&gt;
                  &lt;head&gt;
                    &lt;!-- ... --&gt;
                    &lt;script src="./elements.js"&gt;&lt;/script&gt;
                  &lt;/head&gt;
                  &lt;body&gt;
                    &lt;!-- ... --&gt;
                    &lt;my-custom-element&gt;&lt;/my-custom-element&gt;
                    &lt;!-- ... --&gt;
                  &lt;/body&gt;
                &lt;/html&gt;
            </code></pre>
          </section>

          <section>
            <h2>Input / Output</h2>
            <pre><code data-trim>
                <!-- Inputs as attributes -->
                <my-custom-element 
                    inputId="some-value">
                </my-custom-element>
            </code></pre>

            <pre><code data-trim>
                // Outputs as custom events
                element = document.getElementById('id');
                if (element) {
                  element.addEventListener('outputName', (item: any) =>
                    // some logic
                  );
                }
            </code></pre>
          </section>

          <section>
            <h3>Within Vue / React</h3>
            <pre><code data-trim>
              <!-- VUE: App.vue -->
              <template>
                <div id="app">
                  <my-custom-element></my-custom-element>
                </div>
              </template>
            </code></pre>

            <pre><code data-trim>
              // REACT: App.tsx
              class App extends Componet {
                render() {
                  return (
                    <div className="App">
                      <my-custom-element></my-custom-element>
                    </div>
                  );
                }
              }
            </code></pre>
          </section>

          <section>
            <h2>Examples</h2>
          </section>
        </section>

        <section>
          <section>
            <h2>Considerations</h2>
          </section>

          <section>
            <h3>Custom Element Considerations</h3>
            <ul>
              <li>Element name restrictions</li>
              <li>String attributes only</li>
              <li>
                Browser support (polyfills?)
                <br /><a
                  href="https://caniuse.com/#feat=custom-elementsv1"
                  target="caniuse"
                  ><img src="./caniuse-elements.png"
                /></a>
              </li>
            </ul>
          </section>

          <section>
            <h3>@angular/elements Considerations</h3>
            <div style="font-size: .75em; margin-top:-.5em">
              As of March-2019
            </div>
            <ul>
              <li>Built result isn't that small (our demo = 240KB)</li>
              <li>
                <code>angular-cli</code> doesn't yet have build path for it
              </li>
              <li>
                Building each element indepenently will repeat framework code
              </li>
            </ul>
          </section>

          <section>
            TODO: Limitations within frameworks
          </section>
        </section>

        <section>
          <section>
            <h2>Exporting from React/Vue</h2>
          </section>

          <section>TODO</section>
        </section>
      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          {
            src: 'plugin/highlight/highlight.js',
            async: true,
            callback: function() {
              hljs.initHighlightingOnLoad();
            }
          }
        ],
        history: true
      });
    </script>
  </body>
</html>
